```{r warning=FALSE,message=FALSE}
library(tidyverse)
source("scripts/functions.R")
df <- read.csv("data/main.csv")
set.seed(12042014)
```

### Posterior Predictive Checks

#### 1DAG
```{r warning=FALSE}
post_pred_check(df, "day_4")
```
#### 14DAG
```{r}
post_pred_check(df, "day_17")
```

#### RGR

```{r}
post_pred_check(df, "rgr")
```


#### Height

```{r}
post_pred_check(df, "height_122")
```

### Posterior Predictive Distributions of Delta

```{r}

dag1 <- post_pred(df, "day_4")$delta_pp
dag14 <- post_pred(df, "day_17")$delta_pp
rgr <- post_pred(df, "rgr")$delta_pp
height <- post_pred(df, "height_122")$delta_pp

data.frame(DAG1 = dag1, DAG14= dag14, 
           RGR = rgr, Height = height) %>% 
  pivot_longer(1:4, names_to = "trait", values_to = "delta") %>% 
  mutate(trait = factor(trait, levels = c("Height", "DAG14","DAG1", "RGR"))) %>% 
  group_by(trait) %>% 
  summarise(upr = quantile(delta, .975),
            lwr = quantile(delta, .025),
            upr.5 = quantile(delta, .75),
            lwr.5 = quantile(delta, .25)) %>% 
  ggplot() +
  geom_errorbarh(aes(y = trait, xmin = lwr, xmax = upr), height = 0, 
                 linewidth = 1) +
  geom_errorbarh(aes(y = trait, xmin = lwr.5, xmax = upr.5), height = 0, 
                 linewidth = 2) +
  geom_vline(xintercept = 0, color = "grey", linewidth = 1) +
  theme_minimal()

```



