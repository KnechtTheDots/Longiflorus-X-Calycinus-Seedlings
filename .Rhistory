lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "RGR")
height <- post_pred(df, "height_122", "gamma")$boots
height <- height %>%
pivot_longer(1:4, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "Height")
library(knitr)
library(kableExtra)
library(webshot2)
library(magick)
tab_dat <- bind_rows(dag1, dag14, rgr, height)
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kbl(format = "html") %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
as_image()
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kbl(format = "latex") %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
as_image(file = "figures/table.png")
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kbl() %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
as_image(file = "figures/table.png")
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable() %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
as_image(file = "figures/table.png")
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable() %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16)
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable() %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
save_kable(file = "figures/test_table.ng")
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable() %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
save_kable(file = "figures/table.png")
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable(format = "html") %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
save_kable(file = "figures/table.png")
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable(format = "latex") %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
save_kable(file = "figures/table.png")
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable(format = "latex") %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
kable_as_image(filename = "figure/table.png")
dag1 <- post_pred(df, "day_4", "gamma")$boots
dag1 <- dag1 %>%
pivot_longer(1:4, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "1DAG")
dag14 <- post_pred(df, "day_17", "gamma")$boots
dag14 <- dag14 %>%
pivot_longer(1:4, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "14DAG")
rgr <- post_pred(df, "rgr", "gamma")$boots
rgr <- rgr %>%
pivot_longer(1:4, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "RGR")
height <- post_pred(df, "height_122", "gamma")$boots
height <- height %>%
pivot_longer(1:4, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "Height")
library(knitr)
library(kableExtra)
tab_dat <- bind_rows(dag1, dag14, rgr, height)
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable(format = "latex") %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16)
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable() %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
save_kable("figures/test.pdf")
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable() %>%
kable_classic_2()
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable() %>%
kable_classic_2() %>%
save_kable("figures/test.pdf")
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable() %>%
save_kable("figures/test.pdf")
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kable() %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16)
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kbl(format = "pipe") %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16)
dag1 <- post_pred(df, "day_4", "gamma")$boots
dag1 <- dag1 %>%
pivot_longer(1:4, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "1DAG")
dag14 <- post_pred(df, "day_17", "gamma")$boots
dag14 <- dag14 %>%
pivot_longer(1:4, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "14DAG")
rgr <- post_pred(df, "rgr", "gamma")$boots
rgr <- rgr %>%
pivot_longer(1:4, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "RGR")
height <- post_pred(df, "height_122", "gamma")$boots
height <- height %>%
pivot_longer(1:4, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "Height")
library(knitr)
library(kableExtra)
tab_dat <- bind_rows(dag1, dag14, rgr, height)
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus")) %>%
kbl(format = "pipe") %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,4) %>%
pack_rows("14DAG",5,8) %>%
pack_rows("RGR", 9,12) %>%
pack_rows("Height",13,16) %>%
as_image()
980-437
library(tidyverse)
source("scripts/functions.R")
df <- read.csv("data/main.csv")
set.seed(12042014)
post_pred_check(df, "day_4", lik = "normal")
post_pred_check(df, "day_4", lik = "gamma")
post_pred_check(df, "day_4", lik = "normal")
# post_pred_check(df, "day_4", lik = "gamma")
# post_pred_check(df, "day_4", lik = "log-normal")
post_pred_check(df, "day_17", "normal")
# post_pred_check(df, "day_17", "gamma")
# post_pred_check(df, "day_17", "log-normal")
post_pred_check(df, "rgr", "normal")
# post_pred_check(df, "rgr", "gamma")
# post_pred_check(df, "rgr", "log-normal")
post_pred_check(df, "height_122", "normal")
# post_pred_check(df, "height_122", "gamma")
# post_pred_check(df, "height_122", "log-normal")
dag1 <- post_pred(df, "day_4", "normal")$delta_pp
dag14 <- post_pred(df, "day_17", "normal")$delta_pp
rgr <- post_pred(df, "rgr", "normal")$delta_pp
height <- post_pred(df, "height_122", "normal")$delta_pp
data.frame(DAG1 = dag1, DAG14= dag14,
RGR = rgr, Height = height) %>%
pivot_longer(1:4, names_to = "trait", values_to = "delta") %>%
mutate(trait = factor(trait, levels = c("Height", "DAG14","DAG1", "RGR"))) %>%
group_by(trait) %>%
summarise(upr = quantile(delta, .975),
lwr = quantile(delta, .025),
upr.5 = quantile(delta, .75),
lwr.5 = quantile(delta, .25)) %>%
ggplot() +
geom_vline(xintercept = 0, color = "grey", linewidth = 1) +
geom_errorbarh(aes(y = trait, xmin = lwr, xmax = upr), height = 0,
linewidth = 1) +
geom_errorbarh(aes(y = trait, xmin = lwr.5, xmax = upr.5), height = 0,
linewidth = 2) +
theme_minimal() +
labs(y = "Trait",
x = "O(F2) - E(F2)")
dag1 <- post_pred(df, "day_4", "gamma")$boots
dag1 <- dag1 %>%
pivot_longer(1:5, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "1DAG")
dag1 <- post_pred(df, "day_4", "normal")$boots
dag1 <- dag1 %>%
pivot_longer(1:5, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "1DAG")
dag14 <- post_pred(df, "day_17", "normal")$boots
dag14 <- dag14 %>%
pivot_longer(1:5, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "14DAG")
rgr <- post_pred(df, "rgr", "normal")$boots
rgr <- rgr %>%
pivot_longer(1:5, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "RGR")
height <- post_pred(df, "height_122", "normal")$boots
height <- height %>%
pivot_longer(1:5, names_to = "line", values_to = "trait") %>%
group_by(line) %>%
summarise(mu = round(mean(trait),2),
upr = round(quantile(trait, .975),2),
lwr = round(quantile(trait, .025),2),
upr.5 = round(quantile(trait, .75),2),
lwr.5 = round(quantile(trait, .25),2)) %>%
mutate(trait = "Height")
library(knitr)
library(kableExtra)
tab_dat <- bind_rows(dag1, dag14, rgr, height)
tab_dat %>%
select(Line = line, Mean = mu, "2.5%" = lwr, "25%" = lwr.5,
"75%" = upr.5, "97.5%" = upr) %>%
mutate(Line = case_when(Line == "cal" ~ "Calycinus",
Line == "f1" ~ "F1",
Line == "f2" ~ "F2",
Line == "lon" ~ "Longiflorus",
Line == "e_f2" ~ "Expected F2")) %>%
kbl() %>%
kable_classic_2() %>%
add_header_above(c(" " = 1, "Posterior Distribution of Line Mean" = 5)) %>%
pack_rows("1DAG",1,5) %>%
pack_rows("14DAG",6,10) %>%
pack_rows("RGR", 11,15) %>%
pack_rows("Height",16,20)
(p1 <- dag1 %>%
mutate(plon = c(0, .51, .49, .5, 1),
group = c("a", letters[2:4], "a")) %>%
ggplot(aes(x = plon, y = mu, group = group, color = line)) +
geom_line() +
geom_errorbar(aes(x = plon, ymax = upr, ymin = lwr), width = 0,
linewidth = 1) +
geom_errorbar(aes(x = plon, ymax = upr.5, ymin = lwr.5), width = 0,
linewidth = 2) +
scale_color_manual(values = c("black", "red", "black", "blue", "black")) +
theme_minimal() +
labs(x = "Proportion Longiflorus"))
read.csv("data/seed_growth_vs_seed_size.csv")
d <- read.csv("data/seed_growth_vs_seed_size.csv")
library(tidyverse)
source("scripts/functions.R")
df <- read.csv("data/main.csv")
set.seed(12042014)
d %>% drop_na(day_17)
d %>% drop_na(day_17) %>%
mutate(size = (day_17 - mean(day_17))/sd(day_17))
library(lme4)
install.packages("lme4")
library(lme4)
dat <- d %>% drop_na(day_17) %>%
mutate(size = (day_17 - mean(day_17))/sd(day_17))
dat
dat <- d %>% drop_na(day_17) %>%
mutate(size = (day_17 - mean(day_17))/sd(day_17)) %>%
mutate(survive = death_day - 3)
dat
glm(survive ~ size, family = "binomial", data = dat)
m <- glm(survive ~ size, family = "binomial", data = dat)
summary(m)
?glm
m <- glm(survive ~ size, family = binomial(link = "logit"), data = dat)
summary(m)
d <- read.csv("data/seed_growth_vs_seed_size.csv")
dat <- d %>% drop_na(day_17) %>%
mutate(size = (day_17 - mean(day_17))/sd(day_17)) %>%
mutate(survive = death_day - 3)
m <- glm(survive ~ size, family = "binomial", data = dat)
summary(m)
hist(dat$size)
library(cmdstanr)
rstan:::rstudio_stanc("scripts/survival.stan")
rstan:::rstudio_stanc("scripts/survival.stan")
rstan:::rstudio_stanc("scripts/survival.stan")
mod <- cmdstan_model("scripts/survival.stan")
